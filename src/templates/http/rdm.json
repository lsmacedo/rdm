{
  "name": "$name",
  "description": "",
  "steps": [
    {
      "name": "_data",
      "type": "http",
      "url": "https://api.coindesk.com/v1/bpi/currentprice.json",
      "method": "get",
      "responseType": "json"
    },
    {
      "type": "database",
      "url": "",
      "tables": {
        "currency": {
          "set": {
            "name": "_data.bpi.currencies.*.code",
            "label": "_data.bpi.currencies.*.description"
          },
          "strategy": "upsert",
          "uniqueConstraint": ["name"]
        },
        "rate": {
          "set": {
            "currency_id": "currency.id",
            "value": "_data.bpi.currencies.*.rate"
          },
          "strategy": "upsert",
          "uniqueConstraint": ["currency_id"]
        }
      }
    }
  ]
}
