{
  "name": "Local CSV Dataset Example",
  "description": "Example CSV Dataset",
  "steps": [
    {
      "name": "_track",
      "description": "Read rows from CSV file",
      "type": "file",
      "path": "tracks.csv"
    },
    {
      "description": "Save rows in database",
      "type": "database",
      "url": "postgres://postgres:postgrespassword@localhost/tracks",
      "tables": {
        "track": {
          "set": {
            "name": "_track.title",
            "main_artist_id": "artist.id"
          },
          "strategy": "upsert",
          "uniqueConstraint": ["name", "main_artist_id"]
        },
        "artist": {
          "set": {
            "name": "_track.artist"
          },
          "strategy": "upsert",
          "uniqueConstraint": ["name"]
        },
        "artist_track": {
          "set": {
            "artist_id": "artist.id",
            "track_id": "track.id"
          },
          "strategy": "upsert",
          "uniqueConstraint": ["artist_id", "track_id"]
        }
      }
    }
  ]
}
