{
  "name": "Local JSON Dataset Example",
  "description": "Example JSON of songs with artists array",
  "steps": [
    {
      "name": "_track",
      "description": "Read tracks from JSON file",
      "type": "file",
      "path": "tracks.json"
    },
    {
      "type": "database",
      "description": "Save rows in database",
      "url": "postgres://postgres:postgrespassword@localhost/tracks",
      "tables": {
        "track": {
          "set": {
            "name": "_track.tracks.name",
            "isrc": "_track.tracks.isrc"
          },
          "strategy": "upsert",
          "uniqueConstraint": ["isrc"]
        },
        "artist": {
          "set": {
            "name": "_track.tracks.artists.name"
          },
          "strategy": "upsert",
          "uniqueConstraint": ["name"]
        },
        "artist_track": {
          "set": {
            "artist_id": "artist.id",
            "track_id": "track.id"
          },
          "strategy": "upsert",
          "uniqueConstraint": ["artist_id", "track_id"]
        }
      }
    }
  ]
}
